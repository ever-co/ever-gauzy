<!-- sources-container.component.html -->
<div class="sources-container">
	<!-- Sources List with Drag & Drop -->
	<div cdkDropList (cdkDropListDropped)="drop($event)" class="sources-list">
		@for(source of sources.controls; track source; let idx = $index){
		<div class="source-card" cdkDrag>
			<!-- Glow effect on hover -->
			<div class="card-glow"></div>

			<div class="source-header">
				<div class="drag-area" cdkDragHandle>
					<h5>{{ 'PLUGIN.FORM.SOURCE' | translate }} #{{ idx + 1 }}</h5>
					<nb-icon icon="grid-view" class="drag-icon"></nb-icon>
				</div>
				<button
					nbButton
					ghost
					status="danger"
					size="small"
					(click)="removeSource.emit(idx)"
					class="delete-btn"
					[nbTooltip]="'Delete source' | translate"
					nbTooltipPlacement="top"
				>
					<nb-icon icon="trash-2-outline"></nb-icon>
				</button>
			</div>
			<lib-plugin-source class="grow" [form]="source"></lib-plugin-source>
		</div>
		} @empty {
		<div class="empty-state">
			<nb-icon icon="file-add-outline" class="empty-icon"></nb-icon>
			<h5>{{ 'No Source' | translate }}</h5>
			<p>{{ 'Add First Source' | translate }}</p>
		</div>
		}
	</div>

	<!-- Add Source Section -->
	<div *ngIf="!cantAddMore" class="add-source">
		<div class="add-source-card" (click)="openSourceTypeSelector(); $event.stopPropagation()">
			<div class="add-content">
				<nb-icon icon="plus-circle-outline" class="add-icon"></nb-icon>
				<h5>{{ 'Add New Source' | translate }}</h5>
				<p>{{ 'Click to select source' | translate }}</p>
			</div>

			<div class="source-selector" *ngIf="showSourceSelector">
				<div class="selector-header">
					<h5>Select Source Type</h5>
					<button nbButton ghost size="small" (click)="closeSourceTypeSelector(); $event.stopPropagation()">
						<nb-icon icon="close-outline"></nb-icon>
					</button>
				</div>
				<div class="source-options">
					@for(source of sourceTypes; track source){
					<div class="source-option" (click)="addSource.emit(source); $event.stopPropagation()">
						<nb-icon [icon]="getSourceIcon(source)" class="option-icon"></nb-icon>
						<span>{{ 'PLUGIN.FORM.SOURCE_TYPES.' + source | translate }}</span>
					</div>
					}
				</div>
			</div>
		</div>
	</div>
</div>
