@let plugins = query.plugins$ | async; @let available = (query.count$ | async) > 0; @let isLoading = query.isLoading$ |
async; @let uploading = query.uploading$ | async; @let progress = query.progress$ | async;

<nb-card
	nbInfiniteList
	[threshold]="500"
	[throttleTime]="300"
	(bottomThreshold)="loadMore()"
	class="content-active first"
>
	@if(isLoading) {
	<div class="no-data">
		<ngx-no-data-message message="Marketplace is loading plugins..."></ngx-no-data-message>
	</div>
	} @else if(available) { @for(plugin of plugins; track plugin.id; let isLast = $last) {
	<lib-plugin-marketplace-detail
		class="plugin"
		[ngClass]="{ none: isLast }"
		[plugin]="plugin"
	></lib-plugin-marketplace-detail>
	} } @else {
	<div class="no-data">
		<ngx-no-data-message message="There are no available plugins"></ngx-no-data-message>
	</div>
	} @if(isUploadAvailable){
	<div class="button-upload">
		<button (click)="upload()" nbTooltip="Upload new plugin" status="primary" nbButton>
			<nb-icon *gauzySpinnerButton="uploading" icon="cloud-upload-outline"></nb-icon>
			@if(uploading){
			<span> {{ progress | percent : '1.2-2' }} </span>
			}
		</button>
	</div>
	}
</nb-card>
