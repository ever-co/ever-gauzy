<form [formGroup]="versionForm" (ngSubmit)="submit()">
	<nb-card class="dialog-card" status="basic">
		<nb-card-header class="mb-0">
			<h5 class="title">
				{{
					version
						? ('PLUGIN.DIALOG.VERSION.UPDATE.TITLE' | translate : { number: version.number })
						: ('PLUGIN.DIALOG.VERSION.CREATE.TITLE' | translate : { name: plugin?.name })
				}}
			</h5>
			<button nbButton ghost size="small" (click)="dismiss()" class="close-button">
				<nb-icon icon="close-outline"></nb-icon>
			</button>
		</nb-card-header>
		<nb-card-body>
			<nb-stepper orientation="horizontal" #stepper>
				<!-- Step 1 : Sources -->
				<nb-step [stepControl]="versionForm?.get('sources')" [label]="'PLUGIN.FORM.SOURCES' | translate">
					<lib-source-container
						class="overflow-auto grow"
						[sources]="sources"
						[sourceTypes]="sourceTypes"
						[cantAddMore]="!!version"
						(add)="addSource($event)"
						(remove)="removeSource($event)"
						(restore)="restoreSource($event)"
					></lib-source-container>
					<div class="stepper-buttons">
						<button nbButton status="primary" nbStepperNext>{{ 'BUTTONS.NEXT' | translate }}</button>
					</div>
				</nb-step>

				<!-- Step 2: Version -->
				<nb-step [stepControl]="versionForm?.get('number')" [label]="'PLUGIN.FORM.VERSION' | translate">
					<lib-plugin-version class="grow" [form]="versionForm"></lib-plugin-version>
					<div class="stepper-buttons">
						<button nbButton outline status="basic" nbStepperPrevious>
							{{ 'BUTTONS.PREVIOUS' | translate }}
						</button>
						<button nbButton status="primary" type="submit" [disabled]="isFormInvalid || isSubmitting">
							{{
								version
									? ('BUTTONS.UPDATE' | translate)
									: ('BUTTONS.CREATE' | translate) + (versionNumber ? ' v' + versionNumber : '')
							}}
						</button>
					</div>
				</nb-step>
			</nb-stepper>
		</nb-card-body>
	</nb-card>
</form>
